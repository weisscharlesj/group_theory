
import numpy as np


def R(a, n, k):
    """Calculates the influence of a single, stationary atom's x,y,z vectors when
    calculating the reducible representations for all motions of atoms in a molecle.
    
    See Vincent, A. Molecular Symmetry and Group Theory, 2nd ed.; Wiley, 1997, pp  131.
    
    Parameters
    ----------
    a : int
        1 for E and C_n and -1 for i, S_n, and sigma (reflection)
    n : int
        n from C_n rotation (e.g., n = 2 for 180 degree rotation)
    k : int
        number of rotational increments (e.g., C^3_4 is n = 4 and k = 3)
    Returns
    -------
    np.float
    """
    
    return a + 2 * np.cos(k * 2 * np.pi / n)


atom_contribution = {'c1': [3], 'cs': [3, 1], 'ci': [3, -3], 'c2': [3, -1], 'c3': [3, 0, 0],
                     'c4': [3, 1, -1, 1], 'c5': [3, R(1,1,5), R(1,2,5), R(1,3,5), R(1,4,5)],
                     'c6': [3, 2, 0, -1, 0, 2], 'c7': [3, R(1,1,7), R(1,2,7), R(1,3,7), R(4,1,7), R(1,5,7), R(1,6,7)],
                     'c8': [3, R(1,1,8), 1, -1, 1, R(1,3,8), R(1,5,8), R(1,7,8)], 'd2': [3, -1, -1, -1], 'd3': [3, 0, -1], 
                     'd4': [3, 1, -1, -1, -1], 'd5': [3, R(1,1,5), R(1,2,5), -1], 'd6': [3, 2, 0, -1, -1, -1],
                     'c2v': [3, -1, 1, 1], 'c3v': [3, 0, 1], 'c4v': [3, 1, -1, 1, 1],
                     'c5v': [3, R(1,1,5), R(1,2,5), 1], 'c6v': [3, 2, 0, -1, 1, 1], 'c2h': [3, -1, -3, 1],
                     'c3h': [3, 0, 0, 1, -2, -2], 'c4h': [3, 1, -1, 1, -3, -1, 1, -1], 
                     'c5h': [3, R(1,1,5), R(1,2,5), R(1,3,5), R(1,4,5), 1, R(-1,1,5), R(-1,7,5), R(-1,3,5), R(-1,9,5)],
                     'c6h': [3, 2, 0, -1, 0, 0, 2, -3, R(-1,5,3), R(-1,5,6), 1, R(-1,1,6), R(-1,1,3)], 
                     'd2h': [3, -1, -1, -1, -3, 1, 1, 1], 'd3h': [3, 0, -1, 1, R(-1,1,3), 1], 
                     'd4h': [3, 1, -1, -1, -1, -3, R(-1,1,4), 1, 1, 1],
                     'd5h': [3, R(1,1,5), R(1,2,5), -1, 1, R(-1,1,5), R(-1,3,5), 1], 
                     'd6h': [3, 2, 0, -1, -1, -1, -3, R(-1,1,3), R(-1,1,6), 1, 1, 1],
                     'd8h': [3, R(1,1,8), R(1,3,8), 1, -1, -1, -1, -3, R(-1,1,8), R(-1,3,8), R(-1,1,4), 1, 1, 1],
                     'd2d': [3, R(-1,1,4), -2, -1, 1], 'd3d': [3, 0, -1, -3, R(-1,1,6), 1], 
                     'd4d': [3, R(-1,1,8), 1, R(-1,3,8), -1, -1, 1],
                     'd5d': [3, R(1,1,5), R(1,2,5), -1, -3, R(-1,3,10), R(-1,1,10), 1], 
                     'd6d': [3, R(-1,1,12), 2, R(-1,1,4), 0, R(-1,5,12), -1, -1, 1],
                     's4': [3, R(-1,1,4), -1, R(-1,3,4)], 's6': [3, 0, 0, -3, R(-1,5,6), R(-1,1,6)], 
                     's8': [3, R(-1,1,8), 1, R(-1,3,8), -1, R(-1,5,8), 1, R(-1,7,8)],
                     't': [3, 0, 0, -1], 'th': [3, 0, 0, -1, -3, R(-1,1,6), R(-1,5,6), 1], 
                     'td':[3, 0, -1, R(-1,1,4), 1], 'o': [3, 1, -1, 0, -1], 
                     'oh': [3, 0, -1, 1, -1, -3, R(-1,1,4), R(-1,1,6), 1, 1], 
                     'i': [3, R(1,1,5), R(1,2,5), 0, -1], 
                     'ih': [3, R(1,1,5), R(1,2,5), 0, -1, -3, R(-1,1,10), R(-1,3,10), R(-1,1,6), 1]
                
}

# expanded into ints and floats
atom_contribution = {'c1': [3],
                     'cs': [3, 1],
                     'ci': [3, -3],
                     'c2': [3, -1],
                     'c3': [3, 0, 0],
                     'c4': [3, 1, -1, 1],
                     'c5': [3, 3, -1,0, 1],
                     'c6': [3, 2, 0, -1, 0, 2],
                     'c7': [3, 3, -1, 0, 6, -0.618034, 2],
                     'c8': [3, 3, 1, -1, 1, 0, -0.618034, 2.246980],
                     'd2': [3, -1, -1, -1],
                     'd3': [3, 0, -1],
                     'd4': [3, 1, -1, -1, -1],
                     'd5': [3, 3, -1, -1],
                     'd6': [3, 2, 0, -1, -1, -1],
                     'c2v': [3, -1, 1, 1],
                     'c3v': [3, 0, 1],
                     'c4v': [3, 1, -1, 1, 1],
                     'c5v': [3, 3, -1, 1],
                     'c6v': [3, 2, 0, -1, 1, 1],
                     'c2h': [3, -1, -3, 1],
                     'c3h': [3, 0, 0, 1, -2, -2],
                     'c4h': [3, 1, -1, 1, -3, -1, 1, -1],
                     'c5h': [3, 3, -1, 0), 1, 1, 1, -1.445042, -2, -2.879385],
                     'c6h': [3, 2, 0, -1, 0, 0, 2, -3, -2.618034, -0.381966, 1, 1, 1],
                     'd2h': [3, -1, -1, -1, -3, 1, 1, 1],
                     'd3h': [3, 0, -1, 1, 1, 1],
                     'd4h': [3, 1, -1, -1, -1, -3, 1, 1, 1, 1],
                     'd5h': [3, 3, -1, -1, 1, 1, -2), 1],
                     'd6h': [3, 2, 0, -1, -1, -1, -3, 1, 1, 1, 1, 1],
                     'd8h': [3, 3), 0), 1, -1, -1, -1, -3, 1, -2, 1, 1, 1, 1],
                     'd2d': [3, 1, -2, -1, 1],
                     'd3d': [3, 0, -1, -3, 1, 1],
                     'd4d': [3, 1, 1, -2, -1, -1, 1],
                     'd5d': [3, 3), -1, -1, -3, -2, 1, 1],
                     'd6d': [3, 1, 2, 1, 0, -2.618034, -1, -1, 1],
                     's4': [3, 1, -1, -2)],
                     's6': [3, 0, 0, -3, -0.381966, 1],
                     's8': [3, 1, 1, -2, -1, -2.618034, 1, 0.246980],
                     't': [3, 0, 0, -1],
                     'th': [3, 0, 0, -1, -3, 1, -0.381966, 1],
                     'td': [3, 0, -1, 1, 1],
                     'o': [3, 1, -1, 0, -1],
                     'oh': [3, 0, -1, 1, -1, -3, 1, 1, 1, 1],
                     'i': [3, 3, -1, 0, -1],
                     'ih': [3, 3, -1, 0, -1, -3, 1, -2), 1, 1]}